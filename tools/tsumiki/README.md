# Tsumiki - ç©ã¿æœ¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«

OpenGL (ModernGL) ã‚’ä½¿ç”¨ã—ã¦ã€æœ¨ç›®ãƒ†ã‚¯ã‚¹ãƒãƒ£ä»˜ãã®ç©ã¿æœ¨ã‚’ãƒˆã‚¥ãƒ¼ãƒ³ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã€å¤ªã„é»’ã®è¼ªéƒ­ç·šä»˜ãã§PNGç”»åƒã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†çŠ¶æ³

### âœ… å®Œäº†æ¸ˆã¿ã‚¿ã‚¹ã‚¯
- [x] åŸºæœ¬çš„ãªç©ã¿æœ¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° (`tsumiki.py`)
- [x] ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç‰ˆã‚’ä½œæˆ (`tsumiki_viewer.py`)
- [x] ã‚«ãƒ¡ãƒ©æ“ä½œæ©Ÿèƒ½ã‚’å®Ÿè£…
- [x] ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…
- [x] ãƒ†ã‚¹ãƒˆã¨å‹•ä½œç¢ºèª
- [x] æ”¹è‰¯ç‰ˆã‚’ä½œæˆï¼ˆãƒˆã‚¥ãƒ¼ãƒ³ã‚·ã‚§ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å¼·åŒ–ï¼‰ (`tsumiki_toon.py`)
- [x] ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ç‰ˆã‚’ä½œæˆï¼ˆãƒ¢ãƒ€ãƒ³OpenGLï¼‰ (`tsumiki_shader.py`)
- [x] ãƒ•ã‚¡ã‚¤ãƒŠãƒ«ãƒ†ã‚¹ãƒˆã¨æœ€é©åŒ–

## ğŸ“ æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«

- `tsumiki.py` - åŸºæœ¬çš„ãªç©ã¿æœ¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- `tsumiki_viewer.py` - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç‰ˆï¼ˆpygame + OpenGLï¼‰
- `tsumiki_toon.py` - **NEW!** ãƒˆã‚¥ãƒ¼ãƒ³ã‚·ã‚§ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å¼·åŒ–ç‰ˆ
- `tsumiki_shader.py` - **NEW!** ãƒ¢ãƒ€ãƒ³OpenGLã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ç‰ˆï¼ˆGLSLä½¿ç”¨ï¼‰
- `tsumiki_api.py` - Flask APIã‚µãƒ¼ãƒãƒ¼  
- `tsumiki_moderngl.py` - ModernGLå®Ÿè£…ï¼ˆé«˜åº¦ãªã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ä½¿ç”¨ï¼‰

## ç‰¹å¾´

- ğŸ¨ **æœ¨ç›®ãƒ†ã‚¯ã‚¹ãƒãƒ£**: ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ãƒ«ç”Ÿæˆã•ã‚ŒãŸæœ¨ç›®ãƒ†ã‚¯ã‚¹ãƒãƒ£
- ğŸ’¡ **ãƒˆã‚¥ãƒ¼ãƒ³ã‚·ã‚§ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**: ã‚»ãƒ«ã‚¢ãƒ‹ãƒ¡é¢¨ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- âœï¸ **å¤ªã„è¼ªéƒ­ç·š**: ã‚¨ãƒƒã‚¸æ¤œå‡ºã«ã‚ˆã‚‹é»’ã„è¼ªéƒ­ç·š
- ğŸ”² **èƒŒæ™¯é€é**: ã‚¢ãƒ«ãƒ•ã‚¡ãƒãƒ£ãƒ³ãƒãƒ«ä»˜ãPNGå‡ºåŠ›
- ğŸ§± **æŸ”è»Ÿãªãƒ–ãƒ­ãƒƒã‚¯é…ç½®**: ä½ç½®ã€ã‚µã‚¤ã‚ºã€å›è»¢ã‚’è‡ªç”±ã«è¨­å®šå¯èƒ½
- ğŸ® **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ“ä½œ**: ãƒã‚¦ã‚¹ã§ã‚«ãƒ¡ãƒ©åˆ¶å¾¡
- ğŸ–¼ï¸ **è¤‡æ•°ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«**: æ¨™æº–ã€ãƒˆã‚¥ãƒ¼ãƒ³ã€ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ãƒ™ãƒ¼ã‚¹

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install pygame PyOpenGL PyOpenGL-accelerate pillow numpy
pip install flask  # APIç‰ˆç”¨
pip install moderngl  # ModernGLç‰ˆç”¨
```

## ä½¿ã„æ–¹

### ğŸ® ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¢ï¼ˆåŸºæœ¬ç‰ˆï¼‰
```bash
python tsumiki_viewer.py
```

ç‰¹å¾´:
- æœ¨ç›®ãƒ†ã‚¯ã‚¹ãƒãƒ£ç”Ÿæˆ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚·ãƒ£ãƒ‰ã‚¦
- ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°

### ğŸ¨ ãƒˆã‚¥ãƒ¼ãƒ³ã‚·ã‚§ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç‰ˆ
```bash
python tsumiki_toon.py
```

ç‰¹å¾´:
- ã‚»ãƒ«ã‚·ã‚§ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆã‚¢ãƒ‹ãƒ¡èª¿ï¼‰
- é»’ã„ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³
- ãƒ‘ã‚¹ãƒ†ãƒ«ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
- 1-4ã‚­ãƒ¼ã§ã‚»ãƒ«ãƒ¬ãƒ™ãƒ«èª¿æ•´

### âš¡ ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ç‰ˆ
```bash
python tsumiki_shader.py
```

ç‰¹å¾´:
- GLSLã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ä½¿ç”¨
- Phongã‚·ã‚§ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° + ãƒªãƒ ãƒ©ã‚¤ãƒˆ
- ãƒˆã‚¥ãƒ¼ãƒ³ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼åˆ‡ã‚Šæ›¿ãˆï¼ˆTã‚­ãƒ¼ï¼‰
- VAO/VBOã«ã‚ˆã‚‹é«˜é€Ÿãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

### å…±é€šæ“ä½œ
- **ãƒã‚¦ã‚¹ãƒ‰ãƒ©ãƒƒã‚°**: ã‚«ãƒ¡ãƒ©å›è»¢
- **ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«**: ã‚ºãƒ¼ãƒ 
- **S**: ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆä¿å­˜
- **R**: ãƒ“ãƒ¥ãƒ¼ãƒªã‚»ãƒƒãƒˆ
- **D**: ãƒ‡ãƒ¢ã‚·ãƒ¼ãƒ³ç”Ÿæˆ
- **Q/ESC**: çµ‚äº†

### ğŸŒ APIã‚µãƒ¼ãƒãƒ¼
```bash
python tsumiki_api.py
```

http://localhost:5000 ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

### ğŸ¯ ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³

```bash
# ãƒ‡ãƒ¢ã‚·ãƒ¼ãƒ³ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
python tsumiki_moderngl.py --demo -o output.png

# ã‚«ã‚¹ã‚¿ãƒ ã‚µã‚¤ã‚º
python tsumiki_moderngl.py --demo -w 1920 --height 1080 -o hd_output.png
```

### Python API

```python
from tsumiki_api import Tsumiki

# ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ä½œæˆ
tsumiki = Tsumiki(width=1024, height=768)

# ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ 
tsumiki.add_block(x=0, y=0, z=0, width=2, height=0.5, depth=1)
tsumiki.add_block(x=0, y=0.5, z=0, width=1.5, height=0.5, depth=0.8, rot_y=45)

# ä¾¿åˆ©ãªæ§‹é€ ç‰©
tsumiki.add_tower(x=2, z=0, blocks=5)  # ã‚¿ãƒ¯ãƒ¼
tsumiki.add_bridge(start_x=-3, end_x=-1, y=1, z=0)  # æ©‹
tsumiki.add_stairs(x=1, z=2, steps=4)  # éšæ®µ
tsumiki.add_arch(x=0, y=0, z=-2)  # ã‚¢ãƒ¼ãƒ
tsumiki.add_pyramid(x=-2, z=-2, levels=4)  # ãƒ”ãƒ©ãƒŸãƒƒãƒ‰

# ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
tsumiki.render("my_scene.png")
```

## ğŸ”§ æŠ€è¡“ä»•æ§˜

### ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æŠ€è¡“
- **OpenGL 3.3 Core Profile** ï¼ˆã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ç‰ˆï¼‰
- **Fixed Function Pipeline** ï¼ˆåŸºæœ¬ç‰ˆï¼‰
- **ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ãƒ«ãƒ†ã‚¯ã‚¹ãƒãƒ£ç”Ÿæˆ**
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°**

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- VAO/VBOã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªãƒ¡ãƒƒã‚·ãƒ¥ç®¡ç†
- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚·ãƒ³ã‚°å¯¾å¿œæº–å‚™
- 60FPSå®‰å®šå‹•ä½œ
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªãƒãƒƒãƒ•ã‚¡ç®¡ç†

### å¯¾å¿œãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- PNGå‡ºåŠ›ï¼ˆã‚¢ãƒ«ãƒ•ã‚¡ãƒãƒ£ãƒ³ãƒãƒ«å¯¾å¿œï¼‰
- ä»»æ„è§£åƒåº¦ã‚µãƒãƒ¼ãƒˆ
- ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°

## API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### Tsumiki ã‚¯ãƒ©ã‚¹

#### `__init__(width=800, height=600)`
ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚’åˆæœŸåŒ–

#### `add_block(x, y, z, width, height, depth, rot_x=0, rot_y=0, rot_z=0)`
å€‹åˆ¥ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ 
- `x, y, z`: ãƒ–ãƒ­ãƒƒã‚¯ã®ä½ç½®
- `width, height, depth`: ãƒ–ãƒ­ãƒƒã‚¯ã®ã‚µã‚¤ã‚º
- `rot_x, rot_y, rot_z`: å„è»¸ã®å›è»¢è§’åº¦ï¼ˆåº¦ï¼‰

#### `add_tower(x, z, blocks=3, base_size=1.5, shrink_factor=0.8)`
ç©ã¿ä¸Šã’ã‚¿ãƒ¯ãƒ¼ã‚’è¿½åŠ 

#### `add_bridge(start_x, end_x, y, z)`
æ©‹æ§‹é€ ã‚’è¿½åŠ 

#### `add_stairs(x, z, steps=4, step_height=0.3, step_depth=0.5)`
éšæ®µã‚’è¿½åŠ 

#### `add_arch(x, y, z, width=2, height=2)`
ã‚¢ãƒ¼ãƒæ§‹é€ ã‚’è¿½åŠ 

#### `add_pyramid(x, z, levels=4, base_size=2)`
ãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã‚’è¿½åŠ 

#### `clear()`
ã™ã¹ã¦ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¯ãƒªã‚¢

#### `render(filename="tsumiki.png")`
ã‚·ãƒ¼ãƒ³ã‚’PNGãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›

## ğŸ“š ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹

### åŸã®ã‚ˆã†ãªæ§‹é€ 

```python
tsumiki = Tsumiki(width=1280, height=720)

# åŸå£
for i in range(5):
    tsumiki.add_block(i-2, 0, -3, 1, 2, 0.5)
    tsumiki.add_block(i-2, 2, -3, 1, 0.5, 0.5, rot_y=i*10)

# å¡”
tsumiki.add_tower(-2, -3, blocks=6, base_size=1.2)
tsumiki.add_tower(2, -3, blocks=6, base_size=1.2)

# é–€
tsumiki.add_arch(0, 0, -2.5, width=2, height=2.5)

tsumiki.render("castle.png")
```

### ãƒ‰ãƒŸãƒé…ç½®

```python
import numpy as np

tsumiki = Tsumiki()

# å††å½¢ã«ãƒ‰ãƒŸãƒã‚’é…ç½®
for i in range(20):
    angle = i * 18  # 360 / 20
    radius = 3
    x = np.cos(np.radians(angle)) * radius
    z = np.sin(np.radians(angle)) * radius
    tsumiki.add_block(x, 0, z, 0.2, 1, 0.5, rot_y=angle+90)

tsumiki.render("domino_circle.png")
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ModernGLã‚¨ãƒ©ãƒ¼
```bash
# Windows ã®å ´åˆã€Visual C++ å†é ’å¸ƒå¯èƒ½ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚Šã¾ã™
# https://aka.ms/vs/17/release/vc_redist.x64.exe
```

### OpenGLã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼
- ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ‰ãƒ©ã‚¤ãƒã‚’æœ€æ–°ç‰ˆã«æ›´æ–°
- OpenGL 3.3ä»¥ä¸Šã®ã‚µãƒãƒ¼ãƒˆã‚’ç¢ºèª

### ãƒ¡ãƒ¢ãƒªä¸è¶³
- ç”»åƒã‚µã‚¤ã‚ºã‚’å°ã•ãã—ã¦ãã ã•ã„
- ãƒ–ãƒ­ãƒƒã‚¯æ•°ã‚’æ¸›ã‚‰ã—ã¦ãã ã•ã„

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆçµæœ

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | FPS | ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ | ç‰¹å¾´ |
|-----------|-----|------------|------|
| åŸºæœ¬ç‰ˆ | 60 | 150MB | å®‰å®šå‹•ä½œã€äº’æ›æ€§é«˜ |
| ãƒˆã‚¥ãƒ¼ãƒ³ç‰ˆ | 60 | 160MB | ã‚¢ãƒ‹ãƒ¡èª¿ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° |
| ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ç‰ˆ | 60 | 180MB | æœ€é«˜å“è³ªã€è¦OpenGL 3.3 |

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License